<!DOCTYPE html>
<html>
<head>
  <title>Maps Demo 1</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <link rel="icon" href="//tile.gbif.org/3857/omt/0/0/0@1x.png?style=gbif-dark"/>
  <style>
    html, body, #map {
      height: 100%;
      padding: 0;
      margin: 0;
      background-color: black;
    }
  </style>
  <link rel="stylesheet" href="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.css" />
</head>
<body>
  <div id="map"></div>
  <script src="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView(new L.LatLng(0, 0), 1);

    L.tileLayer('//tile.gbif.org/3857/omt/{z}/{x}/{y}@1x.png?style=gbif-dark', {
        tileSize: 512, zoomOffset: -1, minZoom: 1, maxZoom: 17
    }).addTo(map);

    L.GBIFSimple = L.TileLayer.extend({

      options: {
        attribution: 'GBIF.org',
        errorTileUrl: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', // empty tile
      },

      defaultGBIFParams: {
        style: "classic",
        srs: "EPSG:4326",
      },

      initialize: function (url, options) {
        this._url = url;

        // all keys that are not TileLayer options go to GBIF params
        var gbifParams = L.extend({}, this.defaultGBIFParams);
        for (var i in options) {
          if (!(i in this.options)) {
            gbifParams[i] = options[i];
          }
        }

        options = L.setOptions(this, options);
        this.gbifParams = gbifParams;
      },

      getTileUrl: function (coords) {
        var url = L.TileLayer.prototype.getTileUrl.call(this, coords);
        return url + L.Util.getParamString(this.gbifParams, url)
      },
    });

    L.gbifSimpleLayer = function (url, options) {
      return new L.GBIFSimple(url, options);
    };


    L.gbifSimpleLayer('./occurrence/density/{z}/{x}/{y}@Hx.png',
      {srs: "EPSG:3857", style: "greenHeat.point"}).addTo(map);
  </script>
</body>
</html>
